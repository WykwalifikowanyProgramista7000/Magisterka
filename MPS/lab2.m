a = 0.3;
b = 0.2;
c = 0.05;
d = 0.1;

T1 = 80;
T2 = 10;

matrix_in = [
    1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1;
    1 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 1;
    1 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 1;
    1 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 1;
    1 2 2 2 2 2 2 2 2 2 8 8 8 8 8 8 8 8 8 8 2 2 2 2 2 2 2 2 2 1;
    1 2 2 2 2 2 2 2 2 2 8 8 8 8 8 8 8 8 8 8 2 2 2 2 2 2 2 2 2 1;
    1 2 2 2 2 2 2 2 2 2 8 8 8 8 8 8 8 8 8 8 2 2 2 2 2 2 2 2 2 1;
    1 2 2 2 2 2 2 2 2 2 8 8 8 8 8 8 8 8 8 8 2 2 2 2 2 2 2 2 2 1;
    1 2 2 2 2 2 2 2 2 2 8 8 8 8 8 8 8 8 8 8 2 2 2 2 2 2 2 2 2 1;
    1 1 1 1 1 1 2 2 2 2 8 8 8 8 8 8 8 8 8 8 2 2 2 2 1 1 1 1 1 1;
    0 0 0 0 0 1 2 2 2 2 8 8 8 8 8 8 8 8 8 8 2 2 2 2 1 0 0 0 0 0;
    0 0 0 0 0 1 2 2 2 2 8 8 8 8 8 8 8 8 8 8 2 2 2 2 1 0 0 0 0 0;
    0 0 0 0 0 1 2 2 2 2 8 8 8 8 8 8 8 8 8 8 2 2 2 2 1 0 0 0 0 0;
    0 0 0 0 0 1 2 2 2 2 8 8 8 8 8 8 8 8 8 8 2 2 2 2 1 0 0 0 0 0;
    0 0 0 0 0 1 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 1 0 0 0 0 0;
    0 0 0 0 0 1 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 1 0 0 0 0 0;
    0 0 0 0 0 1 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 1 0 0 0 0 0;
    0 0 0 0 0 1 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 1 0 0 0 0 0;
    0 0 0 0 0 1 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 1 0 0 0 0 0;
    0 0 0 0 0 1 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 1 0 0 0 0 0;
    0 0 0 0 0 1 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 1 0 0 0 0 0;
    0 0 0 0 0 1 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 1 0 0 0 0 0;
    0 0 0 0 0 1 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 1 0 0 0 0 0;
    0 0 0 0 0 1 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 1 0 0 0 0 0;
    0 0 0 0 0 1 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 1 0 0 0 0 0;
    0 0 0 0 0 1 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 1 0 0 0 0 0;
    0 0 0 0 0 1 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 1 0 0 0 0 0;
    0 0 0 0 0 1 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 1 0 0 0 0 0;
    0 0 0 0 0 1 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 1 0 0 0 0 0;
    0 0 0 0 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0;
];

imagesc(matrix_in);

matrix_out = zeros(30,30);

K = 58;
Cw = 450;
ro = 7860;
dx = A/30;
dy = A/30;

for dt = 1 : 0.1 : 100
    
    for i = 1 : 30
        for j = 1 : 30
            if matrix_in(i,j) == 0 
                matrix_out(i,j) = 0;
                continue;
            end
            if matrix_in(i,j) == 1
                matrix_out(i,j) = 10;
                continue;
            end
            if matrix_in(i,j) == 8
                matrix_out(i,j) = 80;
                continue;
            end

            matrix_out(i,j) = matrix_out(i,j) + ((K*dt)/(Cw*ro*(dx^2)))*(matrix_out(i+1,j)-2*matrix_out(i,j)+matrix_out(i-1,j));
            matrix_out(i,j) = matrix_out(i,j) + ((K*dt)/(Cw*ro*(dy^2)))*(matrix_out(i,j+1)-2*matrix_out(i,j)+matrix_out(i,j-1));
        end
    end
end

imagesc(matrix_out);